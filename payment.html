<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Checkout</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f5f5f5;
    padding: 40px;
    text-align: center;
  }

  h1 { color: #6a5acd; margin-bottom: 20px; }

  table {
    margin: 0 auto 30px auto;
    border-collapse: collapse;
    width: 80%;
    max-width: 600px;
  }

  th, td {
    padding: 10px 15px;
    border: 1px solid #ccc;
    text-align: center;
  }

  th { background-color: #6a5acd; color: white; }

  .btn {
    padding: 12px 25px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    margin: 10px;
    color: white;
  }

  .btn-sinpe { background-color: #4CAF50; }
  .btn-back { background-color: #555; }

</style>
</head>
<body>

<h1>Your cart Summary</h1>

<table id="cart-table" border="1" cellpadding="8">
  <thead>
    <tr>
      <th>Product</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Subtotal</th>
    </tr>
  </thead>
  <tbody></tbody>
  </table>

<p id="total"></p>
<div id="paypal-button-container"></div>

<button class="btn btn-sinpe" onclick="pay('sinpe')">Pagar con Sinpe</button>
<br>
<button class="btn btn-back" onclick="goBack()">Volver a productos</button>

<script src="https://www.paypal.com/sdk/js?client-id=AZX8Bi4WkdwtKivAaw4j85-NRiO7RBLMCClgd6YA1MEi2ztfuEIeIGUCnu2b0CtWU2qTVSFSogXqsx-k&currency=USD"></script>

<script>
  const cart = JSON.parse(localStorage.getItem('cart')) || {};
  const tbody = document.querySelector('#cart-table tbody');
  let total = 0;

  for (let key in cart) {
    const item = cart[key];
    const qty = item.quantity;
    const price = item.price;
    const subtotal = qty * price;
    total += subtotal;

    const tr = document.createElement('tr');
    tr.innerHTML = `
    <td>${key}</td>
    <td>${qty}</td>
    <td>$${price.toFixed(2)}</td>
    <td>$${subtotal.toFixed(2)}</td>
    `;
    tbody.appendChild(tr);
     }

  document.getElementById('total').textContent = `Total: $${total.toFixed(2)}`;

  function goBack() {
    window.location.href = 'catalog.html';
  }

   function paySinpe() {
    alert('Redirecting to Sinpe payment with total $' + total.toFixed(2));
  }
  

  // Render PayPal button
  paypal.Buttons({
    createOrder: function(data, actions) {
      return actions.order.create({
        purchase_units: [{
          amount: {
            value: total.toFixed(2) // Total from cart
          }
        }]
      });
    },
    
    onApprove: function(data, actions) {
      return actions.order.capture().then(function(details) {
        alert('Payment completed by ' + details.payer.name.given_name);
        localStorage.removeItem('cart'); // Clear cart
        window.location.href = 'catalog.html';
      });
    }
  }).render('#paypal-button-container');
    
</script>

</body>
</html>
